<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Dados espaciais no R</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="site_libs/anchor-sections-1.0/anchor-sections.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<script src="libs/ace-1.2.3/ace.js" type="text/javascript" charset="utf-8"></script>
<script src="libs/holder-2.9.0/holder.min.js" type="text/javascript" charset="utf-8"></script>
<script src="snippets/snippets.js" type="text/javascript" charset="utf-8"></script>

<!-- google analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-77306155-1', 'auto');
  ga('send', 'pageview');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Cursos 1/2020</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Fundamentos do ERE</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    GIS e Análise Espacial para Ciências Sociais
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="gis.html">Introdução ao QGIS</a>
    </li>
    <li>
      <a href="qgis.html">QGIS e GeoDa</a>
    </li>
    <li>
      <a href="verifica_qgis.html">Verificação de aprendizagem</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    R para Análise Espacial
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="r.html">Introdução ao R e RStudio</a>
    </li>
    <li>
      <a href="r2.html">Estatística descritiva com o R</a>
    </li>
    <li>
      <a href="r3.html">Gráficos no R</a>
    </li>
    <li>
      <a href="r4.html">Dados espaciais no R</a>
    </li>
    <li>
      <a href="r5.html">Análise espacial no R</a>
    </li>
    <li>
      <a href="r6.html">Medidas centrográficas</a>
    </li>
    <li>
      <a href="materialr.html">Dicas sobre R</a>
    </li>
  </ul>
</li>
<li>
  <a href="qualidade.html">Gestão da Qualidade</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/retaoliveira/R">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Dados espaciais no R</h1>
<h4 class="date">Last updated: 07 novembro, 2020</h4>

</div>


<div id="instalação-dos-packages-para-manipulação-de-dados-espaciais-no-r" class="section level2">
<h2>Instalação dos packages para manipulação de dados espaciais no R</h2>
<p>Inicialmente, faz-se necessária a instalação e carregamento dos packages:</p>
<table>
<thead>
<tr class="header">
<th>Package</th>
<th>utilização</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>raster</td>
<td>informações espaciais matriciais</td>
</tr>
<tr class="even">
<td>OpenStreetMap</td>
<td>dados o OSM</td>
</tr>
<tr class="odd">
<td>RgoogleMaps</td>
<td>dados do Google Maps</td>
</tr>
<tr class="even">
<td>grid</td>
<td></td>
</tr>
<tr class="odd">
<td>rgdal</td>
<td>ler e escrever dados espaciais</td>
</tr>
<tr class="even">
<td>tidyverse</td>
<td>organização de dados</td>
</tr>
<tr class="odd">
<td>reshape2</td>
<td></td>
</tr>
<tr class="even">
<td>ggmosaic</td>
<td></td>
</tr>
<tr class="odd">
<td>GISTools</td>
<td>ler e escrever dados espaciais</td>
</tr>
<tr class="even">
<td>sf</td>
<td>manipulação de dados espaciais</td>
</tr>
<tr class="odd">
<td>tmap</td>
<td>mapas temáticos</td>
</tr>
</tbody>
</table>
<pre class="r"><code>library(raster)
library(rJava)
library(OpenStreetMap)
library(RgoogleMaps)
library(grid)
library(rgdal)
library(tidyverse)
library(reshape2)
library(ggmosaic)
library(GISTools)
library(sp)
library(sf)
library(tmap)
library(tmaptools)
library(mapview)</code></pre>
<hr>
</div>
<div id="introdução-aos-packages-sp-e-sf" class="section level2 tabset tabset-fade tabset-pills">
<h2>Introdução aos packages <code>sp</code> e <code>sf</code></h2>
<p>O package <code>sf</code> é uma evolução do package <code>sp</code>. Na maioria dos casos, é interessante utilizar o <code>sf</code>, mas para algumas implementações, como por exemplo o uso de funções no <code>spdep</code> para técnicas de análise espacial, faz-se necessária a utilização do <code>sp</code>.</p>
<div id="dados-espaciais-sp" class="section level3">
<h3>Dados espaciais <code>sp</code></h3>
<p>Por meio do package <code>sp</code> é possível definir classes (ou objetos <code>sp</code>) para manipulação de dados vetoriais pontos, linhas e polígonos.</p>
<p>Formatos de dados espacais no R</p>
<table>
<thead>
<tr class="header">
<th>Sem atributos</th>
<th>Com atributos</th>
<th>Equivalente ESRI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>SpatialPoints</td>
<td>SpatialPointsDataFrame</td>
<td>Point shapefiles</td>
</tr>
<tr class="even">
<td>SpatiaLines</td>
<td>SpatialLinesDataFrame</td>
<td>Line shapefiles</td>
</tr>
<tr class="odd">
<td>SpatialPolygons</td>
<td>SpatialPolygonsDataFrame</td>
<td>Polygon shapefiles</td>
</tr>
</tbody>
</table>
<hr />
</div>
<div id="dados-espaciais-gistools" class="section level3">
<h3>Dados espaciais GISTools</h3>
<p>O package <code>GISTools</code> vem com diferentes bancos de dados que podem ajudar no entendimento das funções. Utilizaremos dois conjuntos dados para explorar as funcionalidades deste package, a saber: (i) dados representados em linhas e polígonos referentes aos municípios na Georgia, considerando New Haven e Connecticut nos EUA. Os dados de New Haven contemplam dados de estatísticas de crimes, rodovias, informações demográficas, ferrovias e locais. O dado da Georgia inclui os limites municipais com alguns atributos relacionados aos dados de 1990 (população total, população rural, que tem curso superior, estrangeira, idosos, linha da pobreza, negros, renda média).</p>
<p>Para carregar os dados, utilize a função <code>data()</code>.</p>
<pre class="r"><code>library(GISTools)
data(newhaven)
ls() # inspecionar os dados</code></pre>
<p>Verifique as classes dos objetos:</p>
<pre class="r"><code>class(breach)</code></pre>
<pre><code>## [1] &quot;SpatialPoints&quot;
## attr(,&quot;package&quot;)
## [1] &quot;sp&quot;</code></pre>
<pre class="r"><code>class(blocks)</code></pre>
<pre><code>## [1] &quot;SpatialPolygonsDataFrame&quot;
## attr(,&quot;package&quot;)
## [1] &quot;sp&quot;</code></pre>
<p>Os dados associados ao objeto <code>blocks</code> podem ser visualizados por meio da função:</p>
<pre class="r"><code>head(data.frame(blocks))</code></pre>
<p>O data frame de um objeto espacial <code>sp</code> também pode ser acessado por meio de <code>@data</code>:</p>
<pre class="r"><code>head(blocks@data)</code></pre>
<p>Os dados das unidades censitárias de New Haven podem ser visualizados por meio de:</p>
<pre class="r"><code>plot(blocks)</code></pre>
<p><img src="r4_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Para plotar as unidades censitárias e as rodovias em vermelho. A função <code>par</code> serve para plotar mais de um gráfico em uma mesma representação. Existem diferentes parâmetros para essa função. Por exemplo, o <code>mfrow</code> refere-se ao número de linhas e colunas para combinar as plotagens.O parâmetro <code>mar</code> ajuda na definição de margens.</p>
<pre class="r"><code>par(mar = c(0,0,0,0))
plot(roads, col=&quot;red&quot;)
plot(blocks, add=TRUE)</code></pre>
<p><img src="r4_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<hr />
</div>
<div id="dados-espaciais-sf" class="section level3">
<h3>Dados espaciais <code>sf</code></h3>
<pre class="r"><code>knitr::include_graphics(&quot;./img/sf.png&quot;)</code></pre>
<p><img src="img/sf.png" width="1784" /></p>
<p>Uma nova classe de objetos espaciais no R foi definida por meio do package denominado <code>sf</code>. O objetivo de desenvolvimento deste package é padronizar o formato dos dados espaciais.</p>
<blockquote>
<p>Uma evolução de dados espaciais no R pode ser vista em <a href="https://edzer.github.io/UseR2017/">Spatial Data in R: New Directions by Edzer Pebesma</a>.</p>
</blockquote>
<p>A ideia por trás do package <code>sf</code> é de que uma feição seja um objeto, ou seja, uma representação de um objeto do mundo real. As feições apresentam informações sobre onde estão localizadas na Terra, e atributos relacionados aos fenômenos reais. Existem muitos tipos de objetos <code>sf</code></p>
<blockquote>
<p>Mais informações sobre o package <code>sf</code> podem ser encontrada em <a href="https://r-spatial.github.io/sf/">Simple Features for R</a></p>
</blockquote>
<p>Os objetos espaciais mais usuais são:</p>
<table>
<colgroup>
<col width="31%" />
<col width="68%" />
</colgroup>
<thead>
<tr class="header">
<th>Tipo</th>
<th>Descrição</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>POINT</td>
<td>zero-dimensional geometry containing a single point</td>
</tr>
<tr class="even">
<td>LINESTRING</td>
<td>sequence of points connected by straight, non-self intersecting line pieces; one-dimensional geometry</td>
</tr>
<tr class="odd">
<td>POLYGON</td>
<td>geometry with a positive area (two-dimensional); sequence of points form a closed, non-self intersecting ring; the first ring denotes the exterior ring, zero or more subsequent rings denote holes in this exterior ring</td>
</tr>
<tr class="even">
<td>MULTIPOINT</td>
<td>set of points; a MULTIPOINT is simple if no two Points in the MULTIPOINT are equal</td>
</tr>
<tr class="odd">
<td>MULTILINESTRING</td>
<td>set of linestrings</td>
</tr>
<tr class="even">
<td>MULTIPOLYGON</td>
<td>set of polygons</td>
</tr>
<tr class="odd">
<td>GEOMETRYCOLLECTION</td>
<td>set of geometries of any type except GEOMETRYCOLLECTION</td>
</tr>
</tbody>
</table>
<pre class="r"><code>library(sf)
vignette(package = &quot;sf&quot;) # visualizar as vignettes

# vignette(&quot;sf1&quot;, package = &quot;sf&quot;)</code></pre>
<p>A forma mais simples de converter os dados considerados para análise das funções de <code>sp</code> em objetos do <code>sf</code> é por meio da função <code>st_as_sf()</code>.</p>
<pre class="r"><code># carregar o dado
data(&quot;georgia&quot;) 

# converter o dado em sf
georgia_sf &lt;- st_as_sf(georgia)
class(georgia_sf)</code></pre>
<pre><code>## [1] &quot;sf&quot;         &quot;data.frame&quot;</code></pre>
<pre class="r"><code>georgia_sf # representa as dez primeiras feições</code></pre>
<pre><code>## Simple feature collection with 159 features and 14 fields
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: -85.6052 ymin: 30.35541 xmax: -80.84126 ymax: 35.00068
## CRS:             +proj=longlat +ellps=WGS84
## First 10 features:
##   Latitude  Longitud TotPop90 PctRural PctBach PctEld PctFB PctPov PctBlack        X       Y    ID     Name MedInc
## 0 31.75339 -82.28558    15744     75.6     8.2  11.43  0.64   19.9    20.76 941396.6 3521764 13001  Appling  32152
## 1 31.29486 -82.87474     6213    100.0     6.4  11.77  1.58   26.0    26.86 895553.0 3471916 13003 Atkinson  27657
## 2 31.55678 -82.45115     9566     61.7     6.6  11.11  0.27   24.1    15.42 930946.4 3502787 13005    Bacon  29342
## 3 31.33084 -84.45401     3615    100.0     9.4  13.17  0.11   24.8    51.67 745398.6 3474765 13007    Baker  29610
## 4 33.07193 -83.25085    39530     42.7    13.3   8.64  1.43   17.5    42.39 849431.3 3665553 13009  Baldwin  36414
## 5 34.35270 -83.50054    10308    100.0     6.4  11.37  0.34   15.1     3.49 819317.3 3807616 13011    Banks  41783
## 6 33.99347 -83.71181    29721     64.6     9.2  10.63  0.92   14.7    11.44 803747.1 3769623 13013   Barrow  49829
## 7 34.23840 -84.83918    55911     75.2     9.0   9.66  0.82   10.7     9.21 699011.5 3793408 13015   Bartow  47309
## 8 31.75940 -83.21976    16245     47.0     7.6  12.81  0.33   22.0    31.33 863020.8 3520432 13017 Ben Hill  28009
## 9 31.27424 -83.23179    14153     66.2     7.5  11.98  1.19   19.3    11.62 859915.8 3466377 13019  Berrien  33786
##                         geometry
## 0 MULTIPOLYGON (((-82.2252 31...
## 1 MULTIPOLYGON (((-82.6293 31...
## 2 MULTIPOLYGON (((-82.52171 3...
## 3 MULTIPOLYGON (((-84.1407 31...
## 4 MULTIPOLYGON (((-83.27423 3...
## 5 MULTIPOLYGON (((-83.39851 3...
## 6 MULTIPOLYGON (((-83.53751 3...
## 7 MULTIPOLYGON (((-84.6533 34...
## 8 MULTIPOLYGON (((-83.17781 3...
## 9 MULTIPOLYGON (((-83.1461 31...</code></pre>
<pre class="r"><code>georgia #apresenta todas as feições</code></pre>
<pre><code>## class       : SpatialPolygonsDataFrame 
## features    : 159 
## extent      : -85.6052, -80.84126, 30.35541, 35.00068  (xmin, xmax, ymin, ymax)
## crs         :  +proj=longlat +ellps=WGS84 
## variables   : 14
## names       : Latitude,  Longitud, TotPop90, PctRural, PctBach, PctEld, PctFB, PctPov, PctBlack,        X,       Y,    ID,    Name, MedInc 
## min values  :  30.7167, -85.50471,     1915,      2.5,     4.2,   1.46,  0.04,    2.6,        0, 635964.3, 3401148, 13001, Appling,  23456 
## max values  : 34.91864, -81.08524,   648951,      100,    37.5,  22.96,  6.74,   35.9,    79.64,  1059706, 3872640, 13321,   Worth,  81603</code></pre>
<p>A função <code>plot</code> também funciona de maneira diferente. Ela permite criar objetos <code>sf</code> e se o objeto tiver atributos, ele demarcará com preenchimento das feições. Teste:</p>
<pre class="r"><code># todos os atributos
plot(georgia_sf)</code></pre>
<p><img src="r4_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<pre class="r"><code>#atributos selecionados
plot(georgia_sf[,6])</code></pre>
<p><img src="r4_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
<pre class="r"><code># atributos selecionados
plot(georgia_sf[,c(4,5)])</code></pre>
<p><img src="r4_files/figure-html/unnamed-chunk-12-3.png" width="672" /></p>
<p>Objetos <code>sf</code> apresentam data frame. O data frame de <code>sp</code> e <code>sf</code> podem ser comparados. No data frame dos objetos <code>sf</code> há atributos de geometria, diferentemente do data frame <code>sp</code>.</p>
<pre class="r"><code>head(data.frame(georgia))</code></pre>
<pre><code>##   Latitude  Longitud TotPop90 PctRural PctBach PctEld PctFB PctPov PctBlack        X       Y    ID     Name MedInc
## 0 31.75339 -82.28558    15744     75.6     8.2  11.43  0.64   19.9    20.76 941396.6 3521764 13001  Appling  32152
## 1 31.29486 -82.87474     6213    100.0     6.4  11.77  1.58   26.0    26.86 895553.0 3471916 13003 Atkinson  27657
## 2 31.55678 -82.45115     9566     61.7     6.6  11.11  0.27   24.1    15.42 930946.4 3502787 13005    Bacon  29342
## 3 31.33084 -84.45401     3615    100.0     9.4  13.17  0.11   24.8    51.67 745398.6 3474765 13007    Baker  29610
## 4 33.07193 -83.25085    39530     42.7    13.3   8.64  1.43   17.5    42.39 849431.3 3665553 13009  Baldwin  36414
## 5 34.35270 -83.50054    10308    100.0     6.4  11.37  0.34   15.1     3.49 819317.3 3807616 13011    Banks  41783</code></pre>
<pre class="r"><code>head(data.frame(georgia_sf))</code></pre>
<pre><code>##   Latitude  Longitud TotPop90 PctRural PctBach PctEld PctFB PctPov PctBlack        X       Y    ID     Name MedInc
## 0 31.75339 -82.28558    15744     75.6     8.2  11.43  0.64   19.9    20.76 941396.6 3521764 13001  Appling  32152
## 1 31.29486 -82.87474     6213    100.0     6.4  11.77  1.58   26.0    26.86 895553.0 3471916 13003 Atkinson  27657
## 2 31.55678 -82.45115     9566     61.7     6.6  11.11  0.27   24.1    15.42 930946.4 3502787 13005    Bacon  29342
## 3 31.33084 -84.45401     3615    100.0     9.4  13.17  0.11   24.8    51.67 745398.6 3474765 13007    Baker  29610
## 4 33.07193 -83.25085    39530     42.7    13.3   8.64  1.43   17.5    42.39 849431.3 3665553 13009  Baldwin  36414
## 5 34.35270 -83.50054    10308    100.0     6.4  11.37  0.34   15.1     3.49 819317.3 3807616 13011    Banks  41783
##                         geometry
## 0 MULTIPOLYGON (((-82.2252 31...
## 1 MULTIPOLYGON (((-82.6293 31...
## 2 MULTIPOLYGON (((-82.52171 3...
## 3 MULTIPOLYGON (((-84.1407 31...
## 4 MULTIPOLYGON (((-83.27423 3...
## 5 MULTIPOLYGON (((-83.39851 3...</code></pre>
<p>Para converter dado espaciais <code>sf</code> para <code>sp</code>, faça:</p>
<pre class="r"><code>g2 &lt;- as(georgia_sf, &quot;Spatial&quot;)
class(g2)</code></pre>
<pre><code>## [1] &quot;SpatialPolygonsDataFrame&quot;
## attr(,&quot;package&quot;)
## [1] &quot;sp&quot;</code></pre>
<hr />
</div>
</div>
<div id="lendo-e-escrevendo-dados-espaciais-no-r" class="section level2 tabset tabset-fade tabset-pills">
<h2>Lendo e escrevendo dados espaciais no R</h2>
<p>Muito frequentemente temos dados no formato <em>shapefile</em> que precisam ser importados para o R. As funções dos packages <code>rgdal</code> e <code>sf</code> permitem essa importação.</p>
<div id="lendo-e-escrevendo-dados-sp." class="section level3">
<h3>Lendo e escrevendo dados <code>sp</code>.</h3>
<p>As funções do <code>rgdal</code> para ler e escrever dados espaciais são, respectivamente: <code>readOGR()</code> e <code>writeOGR()</code>. O objeto <code>georgia</code> em <code>sp</code> pode ser convertido em <em>shapefile</em> como a seguir:</p>
<p>Para ler um <em>shapefile</em>, faça:</p>
<pre class="r"><code>new_georgia &lt;- readOGR(dsn=&quot;./shapefiles/georgia.shp&quot;)</code></pre>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;D:\google_drive\17_sites\courses\shapefiles\georgia.shp&quot;, layer: &quot;georgia&quot;
## with 159 features
## It has 14 fields</code></pre>
<pre class="r"><code>class(new_georgia)</code></pre>
<pre><code>## [1] &quot;SpatialPolygonsDataFrame&quot;
## attr(,&quot;package&quot;)
## [1] &quot;sp&quot;</code></pre>
<p><code>new_georgia</code> é um objeto <code>sp</code>. Observe que o parâmetro <code>dns</code> considerado na função <code>writeOGR</code> endereça o folder onde os arquivos <em>shapefile</em> serão armazenados. Atribuir “.” implica na inclusão dos arquivos no diretório padrão do projeto.</p>
<blockquote>
<p>As funções <code>setwd()</code> e <code>getwd()</code> são úteis para identificar o diretório raiz do projeto e para determinar o diretório de trabalho. Para informações sobre como utilizar a função, acesse ?setwd e ?getwd.</p>
</blockquote>
<p>Funções para ler e escrever dados espaciais do tipo <code>raster</code> podem ser encontradas também no package <code>rgdal</code>. Explore pelo help as funções <code>writeGDAL</code> e <code>readGDAL</code>.</p>
<hr />
</div>
<div id="lendo-e-escrevendo-dados-sf." class="section level3">
<h3>Lendo e escrevendo dados <code>sf</code>.</h3>
<p>O package <code>sf</code> também tem funções que permitem ler e escrever dados espaciais. As funções para isso são <code>st_read()</code> e <code>st_write()</code>. Experimente:</p>
<pre class="r"><code># setwd(&quot;./shapefiles/&quot;)
#g2 &lt;- st_read(&quot;georgia.shp&quot;)</code></pre>
<p>O diretório deve ser especificado para que os dados espaciais sejam varridos de forma efetiva pelas funções. Para escrever utilizando a função <code>st_write()</code> são necessários dois parâmetros: o objeto e o nome do arquivo.</p>
<pre class="r"><code># st_write(g2, &quot;georgia.shp&quot;, delete_layer = TRUE)</code></pre>
<p>Esse comando é igual a:</p>
<pre class="r"><code># st_write(g2, dsn=&quot;georgia.shp&quot;, layer=&quot;georgia.shp&quot;, driver = &quot;ESRI Shapefile&quot;, delete_layer = TRUE)</code></pre>
<hr />
</div>
</div>
<div id="uma-introdução-ao-package-tmap" class="section level2 tabset tabset-fade tabset-pills">
<h2>Uma introdução ao package <code>tmap</code></h2>
<p>O package <code>tmap</code> permite o uso de novas funcionalidades para gerar mapas e funções para extração de dados do Google Maps e do OpenStreetMap. O foco do package <code>tmap</code> é a construção de mapas temáticos. Podem ser considerados dados <code>sp</code> e <code>sf</code>. A gramática para construção dos mapas é similar àquela do package <code>ggplot</code>. Assim, a representação de dados espaciais por meio do <code>tmap</code> conta com a manipulação de cada elemento do mapa separadamente em diferentes camadas. Para limpar o workspace, digite:</p>
<pre class="r"><code>rm(list=ls())</code></pre>
<div id="quick-tmap" class="section level3">
<h3>Quick <code>tmap</code></h3>
<p>A função <code>qtm()</code> pode ser utilizada para composição de mapas de maneira expressa (quick). O código a seguir permite carregar o dado <code>georgia</code>, recriar o dado <code>georgia_sf</code> e gerar um mapa expresso.</p>
<pre class="r"><code>data(&quot;georgia&quot;)
ls()</code></pre>
<pre><code>## [1] &quot;georgia&quot;       &quot;georgia.polys&quot; &quot;georgia2&quot;</code></pre>
<p>Para criar o objeto <code>sf</code> <code>georgia_sf</code>, faça:</p>
<pre class="r"><code>georgia_sf &lt;- st_as_sf(georgia)</code></pre>
<p>Finalmente, crie o mapa expresso utilizando:</p>
<pre class="r"><code>library(tmap)
qtm(georgia, fill=&quot;red&quot;, style = &quot;natural&quot;)</code></pre>
<p><img src="r4_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>O uso do parâmetro <code>style</code> permite configurações rápidas de mapas por meio do package <code>tmap</code>. Explore a função <code>qtm</code> para entender os demais temas possíveis.</p>
<p>O parâmetro <code>fill</code> pode ser utilizado para especificar uma cor ou a variável a ser mapeada.</p>
<pre class="r"><code>qtm(georgia_sf, fill = &quot;MedInc&quot;, text =&quot;Name&quot;, text.size=0.5, format = &quot;World_wide&quot;, style = &quot;classic&quot;, text.root = 5, fill.title = &quot;Median Income&quot;)</code></pre>
<p><img src="r4_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<hr />
</div>
<div id="mapa-completo-por-meio-do-tmap" class="section level3">
<h3>Mapa completo por meio do <code>tmap</code></h3>
<p>Para gerar mapas completos por meio do package <code>tmap</code>, é necessário utilizar a função <code>tm_shape</code>acompanhada de uma outra função que especifique o precisa ser plotado. Antes de plotar, um objeto contendo a linha da divisa estadual da Georgia pode ser criada por meio da função <code>st_union()</code> do package <code>sf</code>. Uma alternativa para dados <code>sp</code> é função <code>gUnaryUnion()</code> do package <code>rgeos</code>, carregado juntamente com o package <code>GISTools</code>.</p>
<pre class="r"><code># união das feições para composição do limite estadual
g &lt;- st_union(georgia_sf)

# plotar as camadas espaciais
tm_shape(georgia_sf) + 
  tm_fill(&quot;tomato&quot;) +
  tm_borders(lty=&quot;dashed&quot;, col = &quot;gold&quot;)</code></pre>
<p><img src="r4_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>Incluir alguns estilos:</p>
<pre class="r"><code># plotar as camadas espaciais
tm_shape(georgia_sf) + 
  tm_fill(&quot;tomato&quot;) +
  tm_borders(lty=&quot;dashed&quot;, col = &quot;gold&quot;) +
  tm_style(&quot;natural&quot;, bg.color = &quot;grey90&quot;)</code></pre>
<p><img src="r4_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>Incluir limite estadual. Repare que a função <code>tm_shape</code> vai ser chamada novamente uma vez que outro objeto será incluído no mapa.</p>
<pre class="r"><code>tm_shape(georgia_sf) + 
  tm_fill(&quot;tomato&quot;) +
  tm_borders(lty=&quot;dashed&quot;, col = &quot;gold&quot;) +
  tm_style(&quot;natural&quot;, bg.color = &quot;grey90&quot;) +
  tm_shape(g) + 
  tm_borders(lwd=2) # lwd - line width - espessura da linha</code></pre>
<p><img src="r4_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p>Incluindo todos os parâmetros juntos:</p>
<pre class="r"><code>tm_shape(georgia_sf) + 
  tm_fill(&quot;tomato&quot;) +
  tm_borders(lty=&quot;dashed&quot;, col = &quot;gold&quot;) +
  tm_style(&quot;natural&quot;, bg.color = &quot;grey90&quot;) +
  tm_shape(g) + 
  tm_borders(lwd=2) +
  tm_layout(title = &quot;O estado da Georgia&quot;,
            title.size = 1,
            title.position = c(0.55, &quot;top&quot;))</code></pre>
<p><img src="r4_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<p>Experimente esses outros parâmetros da função <code>qtm</code>.</p>
<pre class="r"><code>data(World, rivers, metro, land)

# just the map
qtm(World)</code></pre>
<p><img src="r4_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<pre class="r"><code># choropleth
qtm(World, fill = &quot;economy&quot;, format = &quot;World&quot;, style = &quot;col_blind&quot;)</code></pre>
<p><img src="r4_files/figure-html/unnamed-chunk-29-2.png" width="672" /></p>
<pre class="r"><code># choropleth with more specifications
qtm(World, fill=&quot;HPI&quot;, fill.n = 9, fill.palette = &quot;div&quot;,
    fill.title = &quot;Happy Planet Index&quot;, fill.id = &quot;name&quot;, 
    style = &quot;gray&quot;, format = &quot;World&quot;)</code></pre>
<p><img src="r4_files/figure-html/unnamed-chunk-29-3.png" width="672" /></p>
<pre class="r"><code># Alternative to previous map - RECOMENDED
tm_shape(World) +
    tm_polygons(&quot;HPI&quot;, n = 9, palette = &quot;div&quot;,
        title = &quot;Happy Planet Index&quot;, id = &quot;name&quot;) +
    tm_style(&quot;gray&quot;) +
    tm_format(&quot;World&quot;)</code></pre>
<p><img src="r4_files/figure-html/unnamed-chunk-29-4.png" width="672" /></p>
<pre class="r"><code># Bubble map
qtm(World, borders = NULL) + 
qtm(metro, symbols.size = &quot;pop2010&quot;, 
    symbols.title.size= &quot;Metropolitan Areas&quot;, 
    symbols.id= &quot;name&quot;,
    format = &quot;World&quot;)</code></pre>
<p><img src="r4_files/figure-html/unnamed-chunk-29-5.png" width="672" /></p>
<p>Para plotar dois mapas juntos com dados diferentes, experimente o seguinte código:</p>
<pre class="r"><code>library(tmap)

t1 &lt;- tm_shape(georgia_sf) +
              tm_fill(&quot;coral&quot;) +
              tm_borders() +
              tm_layout(bg.color = &quot;grey85&quot;)

t2 &lt;- tm_shape(georgia2) +
              tm_fill(&quot;orange&quot;) +
              tm_borders() +
              tm_layout(asp=0.86, bg.color = &quot;grey95&quot;) #alinhar a segunda figura
t1</code></pre>
<p><img src="r4_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<pre class="r"><code>t2</code></pre>
<p><img src="r4_files/figure-html/unnamed-chunk-30-2.png" width="672" /></p>
<p>Para especificar o layout da figura combinando os mapas:</p>
<pre class="r"><code>library(grid)

# abrir uma nova página de plotagem
grid.newpage()

# definir o layout
pushViewport(viewport(layout = grid.layout(1,2)))

#  Plotar usando o comando print
print(t1, vp=viewport(layout.pos.col = 1, height = 5))
print(t2, vp=viewport(layout.pos.col = 2, height = 5))</code></pre>
<p><img src="r4_files/figure-html/unnamed-chunk-31-1.png" width="672" /> Repare que t1 é um objeto <code>sf</code> e t2 é um objeto <code>sp</code> e apresentam sistemas de referência diferentes.</p>
<p>Para consultar os diferentes sistemas de projeção, verifique utilizando a função <code>crs</code>.</p>
<pre><code>## Warning in showSRID(uprojargs, format = &quot;PROJ&quot;, multiline = &quot;NO&quot;, prefer_proj = prefer_proj): Discarded datum Unknown
## based on WGS84 ellipsoid in CRS definition</code></pre>
<pre><code>## Warning in showSRID(SRS_string, format = &quot;PROJ&quot;, multiline = &quot;NO&quot;, prefer_proj = prefer_proj): Discarded datum Unknown
## based on WGS84 ellipsoid in CRS definition</code></pre>
<pre><code>## CRS arguments: +proj=longlat +ellps=WGS84 +no_defs</code></pre>
<pre><code>## CRS arguments:
##  +proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96 +x_0=0.0 +y_0=0.0 +ellps=GRS80 +units=m +datum=NAD83
## +no_defs +towgs84=0,0,0</code></pre>
<p>Para nomear os atributos, verifique o data.frame do objeto <code>georgia_sf</code>. Utilize a função <code>names()</code> para ter acesso a uma lista de nomes de todos os atributos.</p>
<pre class="r"><code>names(georgia_sf)</code></pre>
<pre><code>##  [1] &quot;Latitude&quot; &quot;Longitud&quot; &quot;TotPop90&quot; &quot;PctRural&quot; &quot;PctBach&quot;  &quot;PctEld&quot;   &quot;PctFB&quot;    &quot;PctPov&quot;   &quot;PctBlack&quot; &quot;X&quot;       
## [11] &quot;Y&quot;        &quot;ID&quot;       &quot;Name&quot;     &quot;MedInc&quot;   &quot;geometry&quot;</code></pre>
<pre class="r"><code># Construir um data frame com os nomes. 
data.frame(georgia_sf)[,13]</code></pre>
<pre><code>##   [1] &quot;Appling&quot;       &quot;Atkinson&quot;      &quot;Bacon&quot;         &quot;Baker&quot;         &quot;Baldwin&quot;       &quot;Banks&quot;         &quot;Barrow&quot;       
##   [8] &quot;Bartow&quot;        &quot;Ben Hill&quot;      &quot;Berrien&quot;       &quot;Bibb&quot;          &quot;Bleckley&quot;      &quot;Brantley&quot;      &quot;Brooks&quot;       
##  [15] &quot;Bryan&quot;         &quot;Bulloch&quot;       &quot;Burke&quot;         &quot;Butts&quot;         &quot;Calhoun&quot;       &quot;Camden&quot;        &quot;Candler&quot;      
##  [22] &quot;Carroll&quot;       &quot;Catoosa&quot;       &quot;Charlton&quot;      &quot;Chatham&quot;       &quot;Chattahoochee&quot; &quot;Chattooga&quot;     &quot;Cherokee&quot;     
##  [29] &quot;Clarke&quot;        &quot;Clay&quot;          &quot;Clayton&quot;       &quot;Clinch&quot;        &quot;Cobb&quot;          &quot;Coffee&quot;        &quot;Colquitt&quot;     
##  [36] &quot;Columbia&quot;      &quot;Cook&quot;          &quot;Coweta&quot;        &quot;Crawford&quot;      &quot;Crisp&quot;         &quot;Dade&quot;          &quot;Dawson&quot;       
##  [43] &quot;Decatur&quot;       &quot;DeKalb&quot;        &quot;Dodge&quot;         &quot;Dooly&quot;         &quot;Dougherty&quot;     &quot;Douglas&quot;       &quot;Early&quot;        
##  [50] &quot;Echols&quot;        &quot;Effingham&quot;     &quot;Elbert&quot;        &quot;Emanuel&quot;       &quot;Evans&quot;         &quot;Fannin&quot;        &quot;Fayette&quot;      
##  [57] &quot;Floyd&quot;         &quot;Forsyth&quot;       &quot;Franklin&quot;      &quot;Fulton&quot;        &quot;Gilmer&quot;        &quot;Glascock&quot;      &quot;Glynn&quot;        
##  [64] &quot;Gordon&quot;        &quot;Grady&quot;         &quot;Greene&quot;        &quot;Gwinnett&quot;      &quot;Habersham&quot;     &quot;Hall&quot;          &quot;Hancock&quot;      
##  [71] &quot;Haralson&quot;      &quot;Harris&quot;        &quot;Hart&quot;          &quot;Heard&quot;         &quot;Henry&quot;         &quot;Houston&quot;       &quot;Irwin&quot;        
##  [78] &quot;Jackson&quot;       &quot;Jasper&quot;        &quot;Jeff Davis&quot;    &quot;Jefferson&quot;     &quot;Jenkins&quot;       &quot;Johnson&quot;       &quot;Jones&quot;        
##  [85] &quot;Lamar&quot;         &quot;Lanier&quot;        &quot;Laurens&quot;       &quot;Lee&quot;           &quot;Liberty&quot;       &quot;Lincoln&quot;       &quot;Long&quot;         
##  [92] &quot;Lowndes&quot;       &quot;Lumpkin&quot;       &quot;McDuffie&quot;      &quot;McIntosh&quot;      &quot;Macon&quot;         &quot;Madison&quot;       &quot;Marion&quot;       
##  [99] &quot;Meriwether&quot;    &quot;Miller&quot;        &quot;Mitchell&quot;      &quot;Monroe&quot;        &quot;Montgomery&quot;    &quot;Morgan&quot;        &quot;Murray&quot;       
## [106] &quot;Muscogee&quot;      &quot;Newton&quot;        &quot;Oconee&quot;        &quot;Oglethorpe&quot;    &quot;Paulding&quot;      &quot;Peach&quot;         &quot;Pickens&quot;      
## [113] &quot;Pierce&quot;        &quot;Pike&quot;          &quot;Polk&quot;          &quot;Pulaski&quot;       &quot;Putnam&quot;        &quot;Quitman&quot;       &quot;Rabun&quot;        
## [120] &quot;Randolph&quot;      &quot;Richmond&quot;      &quot;Rockdale&quot;      &quot;Schley&quot;        &quot;Screven&quot;       &quot;Seminole&quot;      &quot;Spalding&quot;     
## [127] &quot;Stephens&quot;      &quot;Stewart&quot;       &quot;Sumter&quot;        &quot;Talbot&quot;        &quot;Taliaferro&quot;    &quot;Tattnall&quot;      &quot;Taylor&quot;       
## [134] &quot;Telfair&quot;       &quot;Terrell&quot;       &quot;Thomas&quot;        &quot;Tift&quot;          &quot;Toombs&quot;        &quot;Towns&quot;         &quot;Treutlen&quot;     
## [141] &quot;Troup&quot;         &quot;Turner&quot;        &quot;Twiggs&quot;        &quot;Union&quot;         &quot;Upson&quot;         &quot;Walker&quot;        &quot;Walton&quot;       
## [148] &quot;Ware&quot;          &quot;Warren&quot;        &quot;Washington&quot;    &quot;Wayne&quot;         &quot;Webster&quot;       &quot;Wheeler&quot;       &quot;White&quot;        
## [155] &quot;Whitfield&quot;     &quot;Wilcox&quot;        &quot;Wilkes&quot;        &quot;Wilkinson&quot;     &quot;Worth&quot;</code></pre>
<p>Para incluir os nomes, faça:</p>
<pre class="r"><code>tm_shape(georgia_sf) +
              tm_fill(&quot;white&quot;) +
              tm_borders() +
              tm_text(&quot;Name&quot;, size=0.3) +
              tm_layout(frame = FALSE)</code></pre>
<p><img src="r4_files/figure-html/unnamed-chunk-34-1.png" width="672" /> Para criar um subconjunto dos dados, é possível fazer uma seleção criando uma camada com o subconjunto por meio dos índices:</p>
<pre class="r"><code>index &lt;- c(81, 82, 83, 150, 62, 53, 21, 16, 124, 121, 17)
georgia_sub &lt;- georgia_sf[index, ]</code></pre>
<p>Para sobrepor os mapas com as duas camadas, faça:</p>
<pre class="r"><code>tm_shape(georgia_sf) +
              tm_fill(&quot;white&quot;) +
              tm_borders(&quot;grey&quot;, lwd=0.5) +
tm_shape(g) +
              tm_borders(lwd=2) +
tm_shape(georgia_sub) +
              tm_fill(&quot;lightblue&quot;) +
              tm_borders() +
              tm_layout(frame = TRUE, title = &quot;Georgia com subconjunto&quot;, title.size=1, title.position = c(0.02, &quot;bottom&quot;))</code></pre>
<p><img src="r4_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<hr />
</div>
</div>
<div id="sistemas-de-coordenadas" class="section level2">
<h2>Sistemas de coordenadas</h2>
<p>Verificar qual o sistema de referência em uso de dados espaciais vetoriais</p>
<pre class="r"><code>library(sf)
st_crs(georgia_sf)</code></pre>
<pre><code>## Coordinate Reference System:
##   User input:  +proj=longlat +ellps=WGS84 
##   wkt:
## GEOGCRS[&quot;unknown&quot;,
##     DATUM[&quot;Unknown based on WGS84 ellipsoid&quot;,
##         ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
##             LENGTHUNIT[&quot;metre&quot;,1],
##             ID[&quot;EPSG&quot;,7030]]],
##     PRIMEM[&quot;Greenwich&quot;,0,
##         ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
##         ID[&quot;EPSG&quot;,8901]],
##     CS[ellipsoidal,2],
##         AXIS[&quot;longitude&quot;,east,
##             ORDER[1],
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433,
##                 ID[&quot;EPSG&quot;,9122]]],
##         AXIS[&quot;latitude&quot;,north,
##             ORDER[2],
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433,
##                 ID[&quot;EPSG&quot;,9122]]]]</code></pre>
<p>Verificar qual o sistema de referência em uso em dados espaciais matriciais</p>
<div id="sintaxe-proj4" class="section level4">
<h4>Sintaxe <code>Proj4</code></h4>
<table>
<thead>
<tr class="header">
<th>Parâmetro</th>
<th>Significado</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>+a</td>
<td>Semimajor radius of the ellipsoid axis</td>
</tr>
<tr class="even">
<td>+b</td>
<td>Semiminor radius of the ellipsoid axis</td>
</tr>
<tr class="odd">
<td>+datum</td>
<td>Datum name</td>
</tr>
<tr class="even">
<td>+ellps</td>
<td>Ellipsoid name</td>
</tr>
<tr class="odd">
<td>+lat_0</td>
<td>Latitude of origin</td>
</tr>
<tr class="even">
<td>+lat_1</td>
<td>Latitude of first standard parallel</td>
</tr>
<tr class="odd">
<td>+lat_2</td>
<td>Latitude of second standard parallel</td>
</tr>
<tr class="even">
<td>+lat_ts</td>
<td>Latitude of true scale</td>
</tr>
<tr class="odd">
<td>+lon_0</td>
<td>Central meridian</td>
</tr>
<tr class="even">
<td>+over</td>
<td>Allow longitude output outside -180 to 180 range, disables wrapping</td>
</tr>
<tr class="odd">
<td>+proj</td>
<td>Projection name</td>
</tr>
<tr class="even">
<td>+south</td>
<td>Denotes southern hemisphere UTM zone</td>
</tr>
<tr class="odd">
<td>+units</td>
<td>meters, US survey feet, etc.</td>
</tr>
<tr class="even">
<td>+x_0</td>
<td>False easting</td>
</tr>
<tr class="odd">
<td>+y_0</td>
<td>False northing</td>
</tr>
<tr class="even">
<td>+zone</td>
<td>UTM zone</td>
</tr>
</tbody>
</table>
<p><a href="https://proj.org/operations/projections/">Projeções disponíveis no Proj4</a></p>
</div>
<div id="base-de-dados-epgs" class="section level3">
<h3>Base de dados EPGS</h3>
<p><a href="https://spatialreference.org/ref/epsg/">Spatial Reference EPSG</a></p>
</div>
<div id="alterar-projeções" class="section level3">
<h3>Alterar projeções</h3>
<hr />
</div>
</div>
<div id="como-salvar-meu-mapa" class="section level2">
<h2>Como salvar meu mapa</h2>
<pre class="r"><code>data(newhaven)

pdf(file = &#39;map.pdf&#39;) # salva o mapa como pdf.

tm_shape(blocks) +
    tm_borders() +
tm_shape(roads) +
  tm_lines(col = &quot;red&quot;) +
# embellish the map
tm_scale_bar(width = 0.22) +
tm_compass(position = c(0.8, 0.07)) +
tm_layout(frame = F, title = &quot;New Haven, CT&quot;, 
            title.size = 1.5, 
            title.position = c(0.55, &quot;top&quot;), 
            legend.outside = T) 

dev.off() # desconectar o arquivo gerado do ambiente de trabalho. </code></pre>
<p>É possível salvar por meio de outros formatos.</p>
<p>pdf()<br />
png()<br />
tiff()</p>
<hr />
</div>
<div id="adicionando-mapa-de-contexto" class="section level2">
<h2>Adicionando mapa de contexto</h2>
<p>Em algumas situações um mapa de fundo é interessante. Há várias maneiras de fazer essa inclusão. Pelo <code>OpenStreetMap</code>, a ideia é fazer a definição da área a ser representada, fazer o download e plotar o mapa de fundo. Depois acrescentar o mapa em desenvolvimento.</p>
<p><img src="r4_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
</div>
<div id="visualização-de-fenômenos-sociais-no-espaço" class="section level2 tabset tabset-fade tabset-pills">
<h2>Visualização de fenômenos sociais no espaço</h2>
<div id="mapas-coropléticos" class="section level3">
<h3>Mapas coropléticos</h3>
<p><img src="img/coropl.png" width="50%" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="mapas-de-pontos" class="section level3">
<h3>Mapas de pontos</h3>
<p><img src="img/pontos.png" width="50%" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="representação-de-fluxos" class="section level3">
<h3>Representação de fluxos</h3>
<p><img src="img/fluxos.png" width="50%" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="mapas-de-calor" class="section level3">
<h3>Mapas de calor</h3>
<p><img src="img/calor.png" width="60%" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="cartogramas" class="section level3">
<h3>Cartogramas</h3>
<p><img src="img/1_cartograma.png" width="50%" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="símbolos-proporcionais" class="section level3">
<h3>Símbolos proporcionais</h3>
<p><img src="img/pontos_propo.png" width="55%" style="display: block; margin: auto;" /></p>
<hr />
</div>
</div>
<div id="plotar-pontos-a-partir-de-coordenadas" class="section level2">
<h2>Plotar pontos a partir de coordenadas</h2>
<pre class="r"><code>library(sf)
library(tmap)

data &lt;- read_sf(&quot;D:/OneDrive - cefetmg.br/01_disciplinas/ERE/gis/02_pratica/dados_espaciais/ESCOLAS_PARTICULARES/ESCOLAS_PARTICULARES.shp&quot;)
bh &lt;- read_sf(&quot;D:/OneDrive - cefetmg.br/01_disciplinas/ERE/gis/02_pratica/dados_espaciais/BAIRRO/BAIRRO.shp&quot;)

xy &lt;- st_coordinates(data) # arquivo para calculos centrográficos

xy_coord &lt;- as.data.frame(st_coordinates(data)) %&gt;%
   st_as_sf(coords = c(&#39;X&#39;, &#39;Y&#39;), crs = 31983) # conversão em sf para representação espacial de coordenadas como pontos</code></pre>
<pre class="r"><code>tm_shape(data) +
   tm_dots(&quot;ID_EQ_ED&quot;)</code></pre>
<p><img src="r4_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
<pre class="r"><code>tm_shape(xy_coord) +
      tm_dots(col=&quot;red&quot;)</code></pre>
<p><img src="r4_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
<pre class="r"><code>tm_shape(data) + 
   tm_bubbles(&quot;NUMERO&quot;, col=&quot;blue&quot;, alpha = 0.5) + # Considerando os números como número de alunos matriculados
tm_shape(bh) +
   tm_borders(col = &quot;grey40&quot;, lwd = 1, lty = &quot;solid&quot;, alpha = NA)</code></pre>
<p><img src="r4_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
</div>

<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><i class="fab fa-creative-commons fa-2x"></i><i class="fab fa-creative-commons-by fa-2x"></i><i class="fab fa-creative-commons-sa fa-2x"></i>
</a><br />Esta obra esta licenciada sob Licenca <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Atribuicao-Compartilha Igual 4.0 Internacional</a>.


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>


</body>
</html>
